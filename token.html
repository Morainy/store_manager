<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Canvas</title>
</head>
<style>
    * {
        margin: 0;
        padding: 0;
    }

    html,
    body {
        width: 100%;
        height: auto;
    }
</style>

<body>
    <canvas id="canvas" width="740" height="500"></canvas>
    <script>
        /**
         *对Date的扩展，将 Date 转化为指定格式的String
         *月(M)、日(d)、小时(h)、分(m)、秒(s)、季度(q) 可以用 1-2 个占位符，
         *年(y)可以用 1-4 个占位符，毫秒(S)只能用 1 个占位符(是 1-3 位的数字)
         *例子：
         *(new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423
         *(new Date()).Format("yyyy-M-d h:m:s.S")      ==> 2006-7-2 8:9:4.18
         */
        Date.prototype.format = function (fmt) {
            var o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            for (var k in o)
                if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
            return fmt;
        }
        const canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');

        /**
         * @writeTxt: canvas 写入字内容
         * @param {str} t 所需要写入的文字
         * @param {str} s 写入文字的样式
         * @param {arr} p 写入文字的位置
         * @param {arr} a 写入文字对齐方式 默认 居中
         * @param {obj} c 写入文字颜色 默认 #000 
         */
        const writeTxt = (t, s, p, a = 'center', c = '#000') => {
            if (!t) {
                return;
            }
            ctx.font = `${s} bold 黑体`;
            ctx.fillStyle = c;
            ctx.textAlign = a;
            ctx.textBaseline = 'middle';
            ctx.fillText(t, p[0], p[1]);
        }
        /**
         * @drawTable: 画表格 
         */
        const drawTable = () => {
            const headArr = [8, 100, 500, 600, 726]
            const headTxtArr = [
                ['销售方', '鄢陵县弘欣农业发展有限公司', '电话', ' '],
                ['客户名称', ' ', '电话', '']
            ]
            const titleArr = [8, 100, 180, 400, 450, 500, 550, 600, 726];
            const titleTxtArr = [
                ['产品类型', '品牌', '产品名称', '规格', '数量', '单价', '金额','备注']
            ]
            const goodsTxtArr = [
                ['商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '商品名称', ''],
                ['商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '商品名称', ''],
                ['商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '商品名称', ''],
                ['商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '商品名称', ''],
                ['商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '商品名称', ''],
                ['商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '商品名称', '']
            ]

            drawLine(headArr, headTxtArr, 62, 726, 2)
            drawLine(titleArr, titleTxtArr, 123, 726, 1, 16)
            drawLine(titleArr, goodsTxtArr, 154, 726, goodsTxtArr.length, 16, true)
        }

        /**
         * @drawLine: 画table线
         * @param list {arr} 表格竖线x轴位置
         * @param tlist {arr} 表格需要填写文字 无文字 填 ''
         * @param startHei {num} 开始画线的高度
         * @param lineWidth {num} 横线的长度
         * @param n {num} 行数
         * @param txtHei {num} 文字位置调整
         * @param isTrue {boolean} 是否为物资列表
         */
        const drawLine = (list, tlist, startHei, lineWidth, n, txtHei = 14, isTrue = false) => {
            for (let i = 0; i < n; i++) {
                for (let y in list) {
                    if (y !== 0) {
                        const poi = list[y] - (list[y] - list[y - 1]) / 2;
                        writeTxt(tlist[i][y - 1], '12px', [poi, startHei + txtHei + 30 * i])
                    }

                    ctx.moveTo(list[y], startHei);
                    ctx.lineTo(list[y], startHei + 30 * (i + 1));
                }

                if (isTrue) {
                    const mtY = startHei + 30 * n;

                    if (i == 0) {
                        ctx.moveTo(8, startHei + 30 * i);
                        ctx.lineTo(726, startHei + 30 * i);
                    }

                    ctx.moveTo(8, mtY);
                    ctx.lineTo(726, mtY);
                }

                ctx.moveTo(8, startHei + 30 * i);
                ctx.lineTo(lineWidth, startHei + 30 * i);


            }

            if (isTrue) {
                const mtY = startHei + 30 * n;
                ctx.moveTo(8, mtY);
                ctx.lineTo(726, mtY);
            }

            ctx.strokeStyle = '#5a5a59';
            ctx.stroke();
        }

        writeTxt('出货单', '20px', [370, 20])
        writeTxt('公司代码:1232313131', '12px', [12, 48], 'left')
        var str_today = new Date().format("yyyy-MM-dd hh:mm:ss");
        writeTxt('时间：' + str_today, '12px', [698, 48], 'right')
        drawTable()
        writeTxt('收货方签字', '12px', [600, 480], 'right')
    </script>
</body>

</html>